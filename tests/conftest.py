import re

import pandas as pd
import pytest

from src.utils import extract


@pytest.fixture
def al_bad_request() -> dict:
    return {"message": "You have exceeded your API rate limit."}


@pytest.fixture
def al_ok() -> dict:
    return {
        "date": "2018-02-22",
        "historical": "",
        "info": {"rate": 148.972231, "timestamp": 1519328414},
        "query": {"amount": 25.0, "from": "GBP", "to": "JPY"},
        "result": 3724.305775,
        "success": True,
    }


@pytest.fixture
def ms_bad_request() -> dict:
    return {
        "error": {
            "code": "validation_error",
            "message": "Request failed with validation error",
            "context": {"symbols": [{"key": "missing_symbols", "message": "You did not specify any symbols."}]},
        }
    }


@pytest.fixture
def ms_ok() -> dict:
    return {
        "pagination": {"limit": 100, "offset": 0, "count": 100, "total": 9944},
        "data": [
            {
                "open": 129.8,
                "high": 133.04,
                "low": 129.47,
                "close": 132.995,
                "volume": 106686703.0,
                "adj_high": 133.04,
                "adj_low": 129.47,
                "adj_close": 132.995,
                "adj_open": 129.8,
                "adj_volume": 106686703.0,
                "split_factor": 1.0,
                "dividend": 0.0,
                "symbol": "AAPL",
                "exchange": "XNAS",
                "date": "2021-04-09T00:00:00+0000",
            },
        ],
    }


# for fixtures below
# WARN: fixtures for views are pre-counted for current test operations
def operations_raw() -> list[dict]:
    return [
        {
            "Дата операции": "31.12.2021 16:44:00",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -160.89,
            "Валюта операции": "RUB",
            "Сумма платежа": -160.89,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": 5411.0,
            "Описание": "+7 800 555-35-35",
            "Бонусы (включая кэшбэк)": 3,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 160.89,
        },
        {
            "Дата операции": "31.12.2021 16:42:04",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -64.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -64.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 64.0,
        },
        {
            "Дата операции": "31.12.2021 16:39:04",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -118.12,
            "Валюта операции": "RUB",
            "Сумма платежа": -118.12,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": 5411.0,
            "Описание": "+7 800 555-35-35",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 118.12,
        },
        {
            "Дата операции": "31.12.2021 15:44:39",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -78.05,
            "Валюта операции": "RUB",
            "Сумма платежа": -78.05,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 78.05,
        },
        {
            "Дата операции": "31.12.2021 01:23:42",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -564.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -564.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Различные товары",
            "MCC": 5399.0,
            "Описание": "Ozon.ru",
            "Бонусы (включая кэшбэк)": 5,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 564.0,
        },
        {
            "Дата операции": "31.12.2021 00:12:53",
            "Дата платежа": "31.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -800.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -800.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Константин Л.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 800.0,
        },
        {
            "Дата операции": "30.12.2021 22:22:03",
            "Дата платежа": "31.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -20000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -20000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Константин Л.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 20000.0,
        },
        {
            "Дата операции": "30.12.2021 19:18:22",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -7.07,
            "Валюта операции": "RUB",
            "Сумма платежа": -7.07,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 7.07,
        },
        {
            "Дата операции": "30.12.2021 19:06:39",
            "Дата платежа": "31.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -1.32,
            "Валюта операции": "RUB",
            "Сумма платежа": -1.32,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1.32,
        },
        {
            "Дата операции": "30.12.2021 17:50:30",
            "Дата платежа": "30.12.2021",
            "Номер карты": "*4556",
            "Статус": "OK",
            "Сумма операции": 5046.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 5046.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Пополнения",
            "MCC": None,
            "Описание": "Пополнение через Газпромбанк",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 5046.0,
        },
        {
            "Дата операции": "30.12.2021 17:50:17",
            "Дата платежа": "30.12.2021",
            "Номер карты": "*4556",
            "Статус": "OK",
            "Сумма операции": 174000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 174000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Пополнения",
            "MCC": None,
            "Описание": "Пополнение через Газпромбанк",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 174000.0,
        },
        {
            "Дата операции": "30.12.2021 14:48:25",
            "Дата платежа": "30.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -349.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -349.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Канцтовары",
            "MCC": 5943.0,
            "Описание": "Mitrankov M.V.",
            "Бонусы (включая кэшбэк)": 6,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 349.0,
        },
        {
            "Дата операции": "29.12.2021 22:32:24",
            "Дата платежа": "30.12.2021",
            "Номер карты": "*4556",
            "Статус": "OK",
            "Сумма операции": -1411.4,
            "Валюта операции": "RUB",
            "Сумма платежа": -1411.4,
            "Валюта платежа": "RUB",
            "Кэшбэк": 70.0,
            "Категория": "Ж/д билеты",
            "MCC": 4112.0,
            "Описание": "РЖД",
            "Бонусы (включая кэшбэк)": 70,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1411.4,
        },
        {
            "Дата операции": "29.12.2021 22:28:47",
            "Дата платежа": "30.12.2021",
            "Номер карты": "*4556",
            "Статус": "OK",
            "Сумма операции": -1411.4,
            "Валюта операции": "RUB",
            "Сумма платежа": -1411.4,
            "Валюта платежа": "RUB",
            "Кэшбэк": 70.0,
            "Категория": "Ж/д билеты",
            "MCC": 4112.0,
            "Описание": "РЖД",
            "Бонусы (включая кэшбэк)": 70,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1411.4,
        },
        {
            "Дата операции": "29.12.2021 16:22:08",
            "Дата платежа": "29.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -120.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -120.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Mouse Tail",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 120.0,
        },
        {
            "Дата операции": "29.12.2021 15:08:20",
            "Дата платежа": "29.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -383.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -383.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Дом и ремонт",
            "MCC": 5200.0,
            "Описание": "МаксидоМ",
            "Бонусы (включая кэшбэк)": 7,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 383.0,
        },
        {
            "Дата операции": "29.12.2021 14:15:35",
            "Дата платежа": "29.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -67.1,
            "Валюта операции": "RUB",
            "Сумма платежа": -67.1,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Дом и ремонт",
            "MCC": 5200.0,
            "Описание": "Леруа Мерлен",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 67.1,
        },
        {
            "Дата операции": "28.12.2021 18:42:21",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -257.89,
            "Валюта операции": "RUB",
            "Сумма платежа": -257.89,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 12,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 257.89,
        },
        {
            "Дата операции": "28.12.2021 18:24:24",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -210.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -210.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Дом и ремонт",
            "MCC": 5200.0,
            "Описание": "Галамарт",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 210.0,
        },
        {
            "Дата операции": "28.12.2021 18:24:02",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -1840.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -1840.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Дом и ремонт",
            "MCC": 5200.0,
            "Описание": "Галамарт",
            "Бонусы (включая кэшбэк)": 36,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1840.0,
        },
        {
            "Дата операции": "28.12.2021 13:44:39",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -381.48,
            "Валюта операции": "RUB",
            "Сумма платежа": -381.48,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 7,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 381.48,
        },
        {
            "Дата операции": "28.12.2021 13:42:17",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -34.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -34.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Rumyanyj Khleb",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 34.0,
        },
        {
            "Дата операции": "28.12.2021 13:37:02",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -422.22,
            "Валюта операции": "RUB",
            "Сумма платежа": -422.22,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Магнит",
            "Бонусы (включая кэшбэк)": 8,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 422.22,
        },
        {
            "Дата операции": "28.12.2021 09:36:56",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -250.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -250.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 5,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 250.0,
        },
        {
            "Дата операции": "27.12.2021 18:31:43",
            "Дата платежа": "27.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -123.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -123.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Аптеки",
            "MCC": 5912.0,
            "Описание": "Apteka 23",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 123.0,
        },
        {
            "Дата операции": "27.12.2021 15:56:23",
            "Дата платежа": "27.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -35.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -35.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Связь",
            "MCC": 7379.0,
            "Описание": "Devajs Servis.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 35.0,
        },
        {
            "Дата операции": "27.12.2021 12:01:09",
            "Дата платежа": "27.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -40.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -40.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Evo_Lyzhnyj",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 40.0,
        },
        {
            "Дата операции": "27.12.2021 10:42:40",
            "Дата платежа": "27.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -33.54,
            "Валюта операции": "RUB",
            "Сумма платежа": -33.54,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 33.54,
        },
        {
            "Дата операции": "26.12.2021 22:09:56",
            "Дата платежа": "27.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -415.32,
            "Валюта операции": "RUB",
            "Сумма платежа": -415.32,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 20,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 415.32,
        },
        {
            "Дата операции": "26.12.2021 20:39:43",
            "Дата платежа": "28.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -228.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -228.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Такси",
            "MCC": 4121.0,
            "Описание": "Яндекс Такси",
            "Бонусы (включая кэшбэк)": 4,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 228.0,
        },
        {
            "Дата операции": "26.12.2021 16:30:13",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -34.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -34.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Транспорт",
            "MCC": 4131.0,
            "Описание": "Bars 2",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 34.0,
        },
        {
            "Дата операции": "26.12.2021 15:31:11",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -9.64,
            "Валюта операции": "RUB",
            "Сумма платежа": -9.64,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 9.64,
        },
        {
            "Дата операции": "26.12.2021 13:50:58",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -600.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -600.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Цветы",
            "MCC": 5992.0,
            "Описание": "IP Isaeva O.N.",
            "Бонусы (включая кэшбэк)": 12,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 600.0,
        },
        {
            "Дата операции": "26.12.2021 12:33:51",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -34.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -34.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Rumyanyj Khleb",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 34.0,
        },
        {
            "Дата операции": "25.12.2021 22:21:49",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -218.07,
            "Валюта операции": "RUB",
            "Сумма платежа": -218.07,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 10,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 218.07,
        },
        {
            "Дата операции": "25.12.2021 19:59:44",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -115.01,
            "Валюта операции": "RUB",
            "Сумма платежа": -115.01,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 5,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 115.01,
        },
        {
            "Дата операции": "25.12.2021 19:46:44",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -17.33,
            "Валюта операции": "RUB",
            "Сумма платежа": -17.33,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 17.33,
        },
        {
            "Дата операции": "25.12.2021 17:47:43",
            "Дата платежа": "25.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -290.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -290.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "IP Tupikova A.O.",
            "Бонусы (включая кэшбэк)": 5,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 290.0,
        },
        {
            "Дата операции": "25.12.2021 15:30:02",
            "Дата платежа": "25.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -5.7,
            "Валюта операции": "RUB",
            "Сумма платежа": -5.7,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 5.7,
        },
        {
            "Дата операции": "25.12.2021 13:04:15",
            "Дата платежа": "25.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -3400.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -3400.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Развлечения",
            "MCC": 7941.0,
            "Описание": "sevs.eduerp.ru",
            "Бонусы (включая кэшбэк)": 68,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 3400.0,
        },
        {
            "Дата операции": "24.12.2021 20:02:48",
            "Дата платежа": "25.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -100.2,
            "Валюта операции": "RUB",
            "Сумма платежа": -100.2,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Госуслуги",
            "MCC": 9402.0,
            "Описание": "Почта России",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 100.2,
        },
        {
            "Дата операции": "24.12.2021 19:53:32",
            "Дата платежа": "25.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -78.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -78.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Госуслуги",
            "MCC": 9402.0,
            "Описание": "Почта России",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 78.0,
        },
        {
            "Дата операции": "24.12.2021 19:30:55",
            "Дата платежа": "25.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -53.83,
            "Валюта операции": "RUB",
            "Сумма платежа": -53.83,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 53.83,
        },
        {
            "Дата операции": "24.12.2021 18:18:27",
            "Дата платежа": "24.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -34.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -34.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Rumyanyj Khleb",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 34.0,
        },
        {
            "Дата операции": "24.12.2021 15:44:07",
            "Дата платежа": "24.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -2000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -2000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": 'На р/с ООО "ФОРТУНА"',
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 2000.0,
        },
        {
            "Дата операции": "24.12.2021 11:49:17",
            "Дата платежа": "26.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -500.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -500.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Местный транспорт",
            "MCC": 4111.0,
            "Описание": "Метро Санкт-Петербург",
            "Бонусы (включая кэшбэк)": 10,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 500.0,
        },
        {
            "Дата операции": "23.12.2021 22:33:11",
            "Дата платежа": "24.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -1.51,
            "Валюта операции": "RUB",
            "Сумма платежа": -1.51,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1.51,
        },
        {
            "Дата операции": "23.12.2021 21:01:32",
            "Дата платежа": "23.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -2000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -2000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Дмитрий Ш.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 2000.0,
        },
        {
            "Дата операции": "23.12.2021 17:00:31",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -201.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -201.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Канцтовары",
            "MCC": 5943.0,
            "Описание": "IP Mitrankov M V",
            "Бонусы (включая кэшбэк)": 4,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 201.0,
        },
        {
            "Дата операции": "23.12.2021 16:45:12",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*4556",
            "Статус": "OK",
            "Сумма операции": 20000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 20000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Другое",
            "MCC": None,
            "Описание": "Иван С.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 20000.0,
        },
        {
            "Дата операции": "23.12.2021 16:14:59",
            "Дата платежа": "23.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -10000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -10000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Светлана Т.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 10000.0,
        },
        {
            "Дата операции": "23.12.2021 02:34:15",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -50.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -50.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 50.0,
        },
        {
            "Дата операции": "23.12.2021 02:34:14",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -250.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -250.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 12,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 250.0,
        },
        {
            "Дата операции": "23.12.2021 02:34:12",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -50.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -50.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 50.0,
        },
        {
            "Дата операции": "23.12.2021 02:34:11",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -250.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -250.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 12,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 250.0,
        },
        {
            "Дата операции": "22.12.2021 23:30:45",
            "Дата платежа": "23.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": 28001.94,
            "Валюта операции": "RUB",
            "Сумма платежа": 28001.94,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Перевод Кредитная карта. ТП 10.2 RUR",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 28001.94,
        },
        {
            "Дата операции": "22.12.2021 23:30:44",
            "Дата платежа": "23.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -28001.94,
            "Валюта операции": "RUB",
            "Сумма платежа": -28001.94,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Перевод Кредитная карта. ТП 10.2 RUR",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 28001.94,
        },
        {
            "Дата операции": "22.12.2021 23:23:01",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -26.19,
            "Валюта операции": "RUB",
            "Сумма платежа": -26.19,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 26.19,
        },
        {
            "Дата операции": "22.12.2021 22:59:48",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -50.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -50.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 50.0,
        },
        {
            "Дата операции": "22.12.2021 22:59:47",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -250.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -250.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 12,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 250.0,
        },
        {
            "Дата операции": "22.12.2021 21:41:00",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -50.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -50.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 50.0,
        },
        {
            "Дата операции": "22.12.2021 21:40:59",
            "Дата платежа": "23.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -250.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -250.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 12,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 250.0,
        },
        {
            "Дата операции": "22.12.2021 09:14:33",
            "Дата платежа": "22.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -60.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -60.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 60.0,
        },
        {
            "Дата операции": "22.12.2021 09:12:01",
            "Дата платежа": "22.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -34.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -34.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Rumyanyj Khleb",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 34.0,
        },
        {
            "Дата операции": "21.12.2021 22:57:26",
            "Дата платежа": "22.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": 15.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 15.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Другое",
            "MCC": 5817.0,
            "Описание": "Google",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 15.0,
        },
        {
            "Дата операции": "21.12.2021 21:01:16",
            "Дата платежа": "21.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -15.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -15.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Другое",
            "MCC": 5817.0,
            "Описание": "Google",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 15.0,
        },
        {
            "Дата операции": "21.12.2021 18:02:18",
            "Дата платежа": "21.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -100.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -100.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "IP Nelikaev",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 100.0,
        },
        {
            "Дата операции": "21.12.2021 17:21:58",
            "Дата платежа": "21.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -7.94,
            "Валюта операции": "RUB",
            "Сумма платежа": -7.94,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 7.94,
        },
        {
            "Дата операции": "21.12.2021 12:39:51",
            "Дата платежа": "21.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": 1198.23,
            "Валюта операции": "RUB",
            "Сумма платежа": 1198.23,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Перевод Кредитная карта. ТП 10.2 RUR",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1198.23,
        },
        {
            "Дата операции": "21.12.2021 12:39:50",
            "Дата платежа": "21.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -1198.23,
            "Валюта операции": "RUB",
            "Сумма платежа": -1198.23,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Перевод Кредитная карта. ТП 10.2 RUR",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1198.23,
        },
        {
            "Дата операции": "20.12.2021 22:14:18",
            "Дата платежа": "21.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -120.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -120.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "ЛюдиЛюбят",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 120.0,
        },
        {
            "Дата операции": "20.12.2021 21:33:24",
            "Дата платежа": "21.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -1400.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -1400.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Дом и ремонт",
            "MCC": 7699.0,
            "Описание": "YM*o481",
            "Бонусы (включая кэшбэк)": 28,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1400.0,
        },
        {
            "Дата операции": "20.12.2021 19:42:13",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": 421.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 421.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Различные товары",
            "MCC": 5399.0,
            "Описание": "Ozon.ru",
            "Бонусы (включая кэшбэк)": -8,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 421.0,
        },
        {
            "Дата операции": "20.12.2021 19:40:28",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": 232.96,
            "Валюта операции": "RUB",
            "Сумма платежа": 232.96,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Бонусы",
            "MCC": None,
            "Описание": "Выплата по вашему обращению",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 232.96,
        },
        {
            "Дата операции": "20.12.2021 19:35:26",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": 495.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 495.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Бонусы",
            "MCC": None,
            "Описание": "Выплата по вашему обращению",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 495.0,
        },
        {
            "Дата операции": "20.12.2021 10:19:26",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -34.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -34.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Rumyanyj Khleb",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 34.0,
        },
        {
            "Дата операции": "20.12.2021 10:09:30",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -172.69,
            "Валюта операции": "RUB",
            "Сумма платежа": -172.69,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Дикси",
            "Бонусы (включая кэшбэк)": 3,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 172.69,
        },
        {
            "Дата операции": "19.12.2021 20:13:13",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -42.92,
            "Валюта операции": "RUB",
            "Сумма платежа": -42.92,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 42.92,
        },
        {
            "Дата операции": "19.12.2021 18:38:09",
            "Дата платежа": "19.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -186.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -186.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Андрей Х.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 186.0,
        },
        {
            "Дата операции": "19.12.2021 17:46:56",
            "Дата платежа": "19.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -229.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -229.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Evo_Kebab Bar",
            "Бонусы (включая кэшбэк)": 4,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 229.0,
        },
        {
            "Дата операции": "19.12.2021 14:23:55",
            "Дата платежа": "19.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -120.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -120.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Mouse Tail",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 120.0,
        },
        {
            "Дата операции": "19.12.2021 01:15:04",
            "Дата платежа": "19.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -250.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -250.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Связь",
            "MCC": 4814.0,
            "Описание": "МТС",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 250.0,
        },
        {
            "Дата операции": "18.12.2021 20:27:35",
            "Дата платежа": "18.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -120.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -120.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Mouse Tail",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 120.0,
        },
        {
            "Дата операции": "18.12.2021 17:21:34",
            "Дата платежа": "18.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -200.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -200.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Переводы",
            "MCC": None,
            "Описание": "Андрей Х.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 200.0,
        },
        {
            "Дата операции": "18.12.2021 16:53:16",
            "Дата платежа": "20.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -176.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -176.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Топливо",
            "MCC": 5541.0,
            "Описание": "ЛУКОЙЛ",
            "Бонусы (включая кэшбэк)": 3,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 176.0,
        },
        {
            "Дата операции": "18.12.2021 13:48:05",
            "Дата платежа": "18.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -26.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -26.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Транспорт",
            "MCC": 4131.0,
            "Описание": "Pskovpassazhiravtotrans.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 26.0,
        },
        {
            "Дата операции": "18.12.2021 13:28:56",
            "Дата платежа": "18.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -829.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -829.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Лента",
            "Бонусы (включая кэшбэк)": 16,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 829.0,
        },
        {
            "Дата операции": "17.12.2021 23:47:40",
            "Дата платежа": "17.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -232.96,
            "Валюта операции": "RUB",
            "Сумма платежа": -232.96,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Услуги банка",
            "MCC": None,
            "Описание": "Плата за Программу страховой защиты",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 232.96,
        },
        {
            "Дата операции": "17.12.2021 23:40:14",
            "Дата платежа": "18.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -1.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -1.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1.0,
        },
        {
            "Дата операции": "17.12.2021 23:32:49",
            "Дата платежа": "17.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -495.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -495.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Услуги банка",
            "MCC": None,
            "Описание": "Плата за обслуживание",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 495.0,
        },
        {
            "Дата операции": "17.12.2021 16:28:23",
            "Дата платежа": "17.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -229.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -229.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Evo_Kebab Bar",
            "Бонусы (включая кэшбэк)": 4,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 229.0,
        },
        {
            "Дата операции": "17.12.2021 14:52:20",
            "Дата платежа": "17.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -100.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -100.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Сервис",
            "MCC": 7311.0,
            "Описание": "BlaBlaCar",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 100.0,
        },
        {
            "Дата операции": "17.12.2021 13:17:06",
            "Дата платежа": "17.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -192.78,
            "Валюта операции": "RUB",
            "Сумма платежа": -192.78,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 3,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 192.78,
        },
        {
            "Дата операции": "17.12.2021 13:04:00",
            "Дата платежа": "17.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -214.46,
            "Валюта операции": "RUB",
            "Сумма платежа": -214.46,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Магнит",
            "Бонусы (включая кэшбэк)": 4,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 214.46,
        },
        {
            "Дата операции": "17.12.2021 12:07:04",
            "Дата платежа": "17.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -120.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -120.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Mouse Tail",
            "Бонусы (включая кэшбэк)": 2,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 120.0,
        },
        {
            "Дата операции": "16.12.2021 22:52:57",
            "Дата платежа": "16.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": 453.0,
            "Валюта операции": "RUB",
            "Сумма платежа": 453.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Бонусы",
            "MCC": None,
            "Описание": "Кэшбэк за обычные покупки",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 453.0,
        },
        {
            "Дата операции": "16.12.2021 22:25:54",
            "Дата платежа": "16.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": 130.82,
            "Валюта операции": "RUB",
            "Сумма платежа": 130.82,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Бонусы",
            "MCC": None,
            "Описание": "Проценты на остаток",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 130.82,
        },
        {
            "Дата операции": "16.12.2021 16:40:47",
            "Дата платежа": "16.12.2021",
            "Номер карты": None,
            "Статус": "OK",
            "Сумма операции": -14216.42,
            "Валюта операции": "RUB",
            "Сумма платежа": -14216.42,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "ЖКХ",
            "MCC": None,
            "Описание": "ЖКУ Квартира",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 14216.42,
        },
        {
            "Дата операции": "16.12.2021 16:27:01",
            "Дата платежа": "16.12.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -11.49,
            "Валюта операции": "RUB",
            "Сумма платежа": -11.49,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Каршеринг",
            "MCC": 7512.0,
            "Описание": "Ситидрайв",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 11.49,
        },
        {
            "Дата операции": "16.12.2021 16:15:55",
            "Дата платежа": "16.12.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -1150.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -1150.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": None,
            "Категория": "Дом и ремонт",
            "MCC": 5712.0,
            "Описание": "Ofisnaya mebel",
            "Бонусы (включая кэшбэк)": 23,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1150.0,
        },
    ]


@pytest.fixture
def operations_list() -> list[dict]:
    return operations_raw()


@pytest.fixture
def operations() -> pd.DataFrame:
    ops = operations_raw()
    for op in ops:
        op.update(
            {
                "Дата операции": pd.to_datetime(op["Дата операции"], format="%d.%m.%Y %H:%M:%S"),
                "Дата платежа": pd.to_datetime(op["Дата платежа"], format="%d.%m.%Y"),
            }
        )
    return pd.DataFrame(ops)


@pytest.fixture
def ops_phone() -> list[dict]:
    ops = operations_raw()
    # for op in ops:
    #     op.update({"Дата операции": pd.to_datetime(op["Дата операции"], dayfirst=True),
    #     "Дата платежа": pd.to_datetime(op["Дата платежа"], dayfirst=True)})
    pat = re.compile(r"\+7.\d{3}.\d{3}-\d{2}-\d{2}")
    ops = [op for op in ops if pat.search(extract(op, ("Описание",)))]
    return ops


@pytest.fixture
def ops_individuals() -> list[dict]:
    ops = operations_raw()
    # for op in ops:
    #     op.update({"Дата операции": pd.to_datetime(op["Дата операции"], dayfirst=True),
    #     "Дата платежа": pd.to_datetime(op["Дата платежа"], dayfirst=True)})
    pat = re.compile(r"[А-Я][а-я]+.[А-Я]\.")
    ops = [op for op in ops if pat.search(extract(op, ("Описание",))) and extract(op, ("Категория",)) == "Переводы"]
    return ops


@pytest.fixture
def ops_str_search() -> list[dict]:
    ops = operations_raw()
    # for op in ops:
    #     op.update(
    #         {
    #             "Дата операции": pd.to_datetime(op["Дата операции"], dayfirst=True).strftime("%d.%m.%Y %H:%M:%S"),
    #             "Дата платежа": pd.to_datetime(op["Дата платежа"], dayfirst=True).strftime("%d.%m.%Y"),
    #         }
    #     )
    ops = [op for op in ops if ("банк" in extract(op, ("Категория",))) or ("банк" in extract(op, ("Описание",)))]
    return ops


@pytest.fixture
def ops_cards_stats() -> list[dict]:
    return [
        {"last_digits": "7197", "total_spent": 15462.49, "cashback": 0},
        {"last_digits": "5091", "total_spent": 3394.27, "cashback": 0},
        {"last_digits": "4556", "total_spent": 2822.8, "cashback": 140.0},
    ]


@pytest.fixture
def ops_top() -> list[dict]:
    return [
        {
            "date": "30.12.2021",
            "amount": 174000.0,
            "category": "Пополнения",
            "description": "Пополнение через Газпромбанк",
        },
        {
            "date": "23.12.2021",
            "amount": 28001.94,
            "category": "Переводы",
            "description": "Перевод Кредитная карта. ТП 10.2 RUR",
        },
        {
            "date": "23.12.2021",
            "amount": 28001.94,
            "category": "Переводы",
            "description": "Перевод Кредитная карта. ТП 10.2 RUR",
        },
        {"date": "31.12.2021", "amount": 20000.0, "category": "Переводы", "description": "Константин Л."},
        {"date": "23.12.2021", "amount": 20000.0, "category": "Другое", "description": "Иван С."},
    ]
